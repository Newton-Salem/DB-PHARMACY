@page
@model PHARMACY.Pages.Customer.Orders.FeedbackModel
@{
    ViewData["Title"] = "Order Feedback";
}

<style>
    /* ===== Card Animation ===== */
    .feedback-card {
        border-radius: 22px;
        border: none;
        animation: popIn 0.7s ease;
    }

    @@keyframes popIn {
        0%

    {
        opacity: 0;
        transform: scale(0.9);
    }

    100% {
        opacity: 1;
        transform: scale(1);
    }

    }

    /* ===== Icon ===== */
    .feedback-icon {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea, #764ba2);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 36px;
        color: #fff;
        margin: auto;
        animation: float 2.5s ease-in-out infinite;
    }

    @@keyframes float {
        0%

    {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-6px);
    }

    100% {
        transform: translateY(0);
    }

    }

    /* ===== Stars ===== */
    .stars {
        font-size: 38px;
        text-align: center;
        margin-bottom: 10px;
    }

        .stars span {
            cursor: pointer;
            color: #ddd;
            transition: all 0.3s ease;
            margin: 0 5px;
        }

            .stars span:hover {
                transform: scale(1.3);
            }

            .stars span.active {
                color: #f1c40f;
                text-shadow: 0 0 10px rgba(241,196,15,0.6);
            }

    /* ===== Textarea ===== */
    .feedback-textarea {
        border-radius: 16px;
        resize: none;
        transition: all 0.3s ease;
    }

        .feedback-textarea:focus {
            box-shadow: 0 0 0 0.2rem rgba(102,126,234,0.25);
        }

    /* ===== Buttons ===== */
    .submit-btn {
        border-radius: 16px;
        transition: all 0.3s ease;
    }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(102,126,234,0.35);
        }

    .cancel-btn {
        border-radius: 16px;
    }

    /* ===== Success Animation ===== */
    .success-box {
        animation: successPop 0.8s ease;
    }

    @@keyframes successPop {
        0%

    {
        opacity: 0;
        transform: scale(0.8);
    }

    100% {
        opacity: 1;
        transform: scale(1);
    }

    }
</style>

<div class="container d-flex justify-content-center align-items-center mt-5">
    <div class="col-md-7 col-lg-6">
        <div class="card shadow feedback-card">

            <!-- Header -->
            <div class="card-header bg-white border-0 text-center pt-4">
                <div class="feedback-icon mb-2">📝</div>
                <h4 class="fw-bold text-primary mb-0">Order Feedback</h4>
                <small class="text-muted">Order #@Model.OrderId</small>
            </div>

            <!-- Body -->
            <div class="card-body px-4 pb-4">

                @if (!Model.AlreadySubmitted)
                {
                    <form method="post">
                        <input type="hidden" asp-for="OrderId" />
                        <input type="hidden" name="Rating" id="ratingValue" value="0" />

                        <!-- ⭐ Stars -->
                        <div class="text-center mb-4">
                            <div class="stars" id="starRating">
                                <span data-value="1">★</span>
                                <span data-value="2">★</span>
                                <span data-value="3">★</span>
                                <span data-value="4">★</span>
                                <span data-value="5">★</span>
                            </div>
                            <small class="text-muted">Tap to rate your experience</small>
                        </div>

                        <!-- Feedback -->
                        <div class="mb-4">
                            <label class="form-label fw-semibold">
                                Tell us about your experience
                            </label>
                            <textarea asp-for="FeedbackText"
                                      class="form-control feedback-textarea"
                                      rows="5"
                                      placeholder="Write your feedback here..."
                                      required></textarea>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary submit-btn py-2">
                                🚀 Submit Feedback
                            </button>

                            <a asp-page="/Customer/Orders/Index"
                               class="btn btn-outline-secondary cancel-btn py-2">
                                Cancel
                            </a>
                        </div>
                    </form>
                }
                else
                {
                    <!-- ✅ Success -->
                    <div class="alert alert-success text-center success-box mt-4">
                        <h4 class="mb-2">🎉 Thank You!</h4>
                        <p class="mb-0 text-muted">
                            Your feedback has been submitted successfully.
                        </p>
                    </div>
                }

            </div>
        </div>
    </div>
</div>

<script>
    const stars = document.querySelectorAll("#starRating span");
    const ratingInput = document.getElementById("ratingValue");

    stars.forEach(star => {
        star.addEventListener("click", () => {
            const value = star.getAttribute("data-value");
            ratingInput.value = value;

            stars.forEach(s => {
                s.classList.remove("active");
                if (s.getAttribute("data-value") <= value) {
                    s.classList.add("active");
                }
            });
        });
    });
</script>
